-- ======================================
-- DROP TABLES E VIEWS (se existirem)
-- ======================================
DROP VIEW IF EXISTS vw_melhor_preco_peca CASCADE;
DROP TABLE IF EXISTS notificacoes CASCADE;
DROP TABLE IF EXISTS orcamento_cupons CASCADE;
DROP TABLE IF EXISTS cupons_desconto CASCADE;
DROP TABLE IF EXISTS avaliacoes_produtos CASCADE;
DROP TABLE IF EXISTS historico_preco CASCADE;
DROP TABLE IF EXISTS log_sistema CASCADE;
DROP TABLE IF EXISTS pagamentos CASCADE;
DROP TABLE IF EXISTS pedido_loja_itens CASCADE;
DROP TABLE IF EXISTS pedido_loja CASCADE;
DROP TABLE IF EXISTS pedidos CASCADE;
DROP TABLE IF EXISTS orcamento_itens CASCADE;
DROP TABLE IF EXISTS orcamentos CASCADE;
DROP TABLE IF EXISTS montagem_itens CASCADE;
DROP TABLE IF EXISTS montagens_pc CASCADE;
DROP TABLE IF EXISTS compatibilidade_peca CASCADE;
DROP TABLE IF EXISTS loja_peca CASCADE;
DROP TABLE IF EXISTS pecas CASCADE;
DROP TABLE IF EXISTS marcas CASCADE;
DROP TABLE IF EXISTS categorias CASCADE;
DROP TABLE IF EXISTS usuarios_lojas CASCADE;
DROP TABLE IF EXISTS perfis_usuarios CASCADE;
DROP TABLE IF EXISTS usuarios CASCADE;
DROP TABLE IF EXISTS produtos_afiliados CASCADE;
DROP TABLE IF EXISTS monitores CASCADE;
DROP TABLE IF EXISTS perifericos CASCADE;
DROP TABLE IF EXISTS placas_mae CASCADE;
DROP TABLE IF EXISTS processadores CASCADE;
DROP TABLE IF EXISTS produtos CASCADE;
DROP TABLE IF EXISTS lojas_afiliadas CASCADE;
DROP TABLE IF EXISTS placas_video CASCADE;
-- NOVA TABELA para Ativos do Site
DROP TABLE IF EXISTS ativos_site CASCADE;

-- ======================================
-- CRIAÇÃO DAS TABELAS
-- ======================================

-- Tabela Lojas Afiliadas
CREATE TABLE lojas_afiliadas (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE,
    site_url TEXT,
    logo_url TEXT
);

-- Tabela Produtos
CREATE TABLE produtos (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE,
    preco NUMERIC(10,2),
    categoria TEXT,
    imagem_url TEXT,
    marca TEXT,
    modelo TEXT
);

-- Tabela Produtos Afiliados
CREATE TABLE produtos_afiliados (
    id SERIAL PRIMARY KEY,
    produto_id INT REFERENCES produtos(id),
    loja_id INT REFERENCES lojas_afiliadas(id),
    preco NUMERIC(10,2),
    url_afiliado TEXT,
    UNIQUE(produto_id, loja_id)
);

-- Tabela Processadores
CREATE TABLE processadores (
    produto_id INT PRIMARY KEY REFERENCES produtos(id),
    nucleos INT,
    threads INT,
    frequencia NUMERIC(4,2),
    socket TEXT
);

-- Tabela Placas Mãe
CREATE TABLE placas_mae (
    produto_id INT PRIMARY KEY REFERENCES produtos(id),
    chipset TEXT,
    socket TEXT,
    memoria TEXT,
    slots_memoria INT
);

-- Tabela Placas de Vídeo
CREATE TABLE placas_video (
    produto_id INT PRIMARY KEY REFERENCES produtos(id),
    memoria_vram NUMERIC(4,1),
    interface TEXT,
    barramento TEXT
);

-- Tabela Periféricos
CREATE TABLE perifericos (
    produto_id INT PRIMARY KEY REFERENCES produtos(id),
    tipo TEXT,
    caracteristica TEXT
);

-- Tabela Monitores
CREATE TABLE monitores (
    produto_id INT PRIMARY KEY REFERENCES produtos(id),
    polegadas NUMERIC(4,1),
    resolucao TEXT,
    taxa_atualizacao INT
);

-- NOVA TABELA: Ativos do Site (para logo, banner, etc.)
CREATE TABLE ativos_site (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE,
    tipo TEXT,
    url TEXT
);

-- Tabela Perfis de Usuários
CREATE TABLE perfis_usuarios (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE
);

-- Tabela Usuários
CREATE TABLE usuarios (
    id SERIAL PRIMARY KEY,
    nome TEXT,
    email TEXT UNIQUE,
    senha TEXT,
    perfil_id INT REFERENCES perfis_usuarios(id)
);

-- Tabela Marcas
CREATE TABLE marcas (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE
);

-- Tabela Categorias
CREATE TABLE categorias (
    id SERIAL PRIMARY KEY,
    nome TEXT UNIQUE
);

-- Tabela de Compatibilidade de Peças
CREATE TABLE compatibilidade_peca (
    id SERIAL PRIMARY KEY,
    peca1_id INT REFERENCES produtos(id),
    peca2_id INT REFERENCES produtos(id),
    status TEXT, -- Ex: 'compativel', 'incompativel', 'aviso'
    UNIQUE(peca1_id, peca2_id)
);

-- Tabela Montagens de PC (configurações salvas)
CREATE TABLE montagens_pc (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id),
    nome_montagem TEXT,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela Itens da Montagem
CREATE TABLE montagem_itens (
    id SERIAL PRIMARY KEY,
    montagem_id INT REFERENCES montagens_pc(id),
    produto_id INT REFERENCES produtos(id)
);

-- Tabela Orçamentos (carrinho)
CREATE TABLE orcamentos (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    total NUMERIC(10,2)
);

-- Tabela Itens do Orçamento
CREATE TABLE orcamento_itens (
    id SERIAL PRIMARY KEY,
    orcamento_id INT REFERENCES orcamentos(id),
    produto_id INT REFERENCES produtos(id),
    quantidade INT,
    preco_unitario NUMERIC(10,2)
);

-- Tabela Pedidos (conclusão da compra)
CREATE TABLE pedidos (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id),
    data_pedido TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status TEXT, -- Ex: 'pendente', 'processando', 'concluido'
    total_pedido NUMERIC(10,2)
);

-- Tabela Pedido por Loja (detalha de qual loja o item veio)
CREATE TABLE pedido_loja (
    id SERIAL PRIMARY KEY,
    pedido_id INT REFERENCES pedidos(id),
    loja_id INT REFERENCES lojas_afiliadas(id),
    total_loja NUMERIC(10,2)
);

-- Tabela Itens do Pedido por Loja
CREATE TABLE pedido_loja_itens (
    id SERIAL PRIMARY KEY,
    pedido_loja_id INT REFERENCES pedido_loja(id),
    produto_afiliado_id INT REFERENCES produtos_afiliados(id),
    quantidade INT,
    preco_unitario NUMERIC(10,2)
);

-- Tabela Pagamentos
CREATE TABLE pagamentos (
    id SERIAL PRIMARY KEY,
    pedido_id INT REFERENCES pedidos(id),
    data_pagamento TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    valor NUMERIC(10,2),
    metodo TEXT,
    status TEXT -- Ex: 'aprovado', 'recusado'
);

-- Tabela de Log do Sistema
CREATE TABLE log_sistema (
    id SERIAL PRIMARY KEY,
    data_hora TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    tipo TEXT, -- Ex: 'erro', 'aviso', 'informacao'
    descricao TEXT
);

-- Tabela de Histórico de Preço
CREATE TABLE historico_preco (
    id SERIAL PRIMARY KEY,
    produto_afiliado_id INT REFERENCES produtos_afiliados(id),
    preco_anterior NUMERIC(10,2),
    preco_novo NUMERIC(10,2),
    data_atualizacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de Avaliações de Produtos
CREATE TABLE avaliacoes_produtos (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id),
    produto_id INT REFERENCES produtos(id),
    nota INT CHECK (nota >= 1 AND nota <= 5),
    comentario TEXT,
    data_avaliacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de Cupons de Desconto
CREATE TABLE cupons_desconto (
    id SERIAL PRIMARY KEY,
    codigo TEXT UNIQUE,
    valor_desconto NUMERIC(10,2),
    tipo TEXT, -- Ex: 'porcentagem', 'valor_fixo'
    data_validade DATE,
    ativo BOOLEAN DEFAULT TRUE
);

-- Tabela de Junção para Cupons e Orçamentos
CREATE TABLE orcamento_cupons (
    orcamento_id INT REFERENCES orcamentos(id),
    cupom_id INT REFERENCES cupons_desconto(id),
    PRIMARY KEY (orcamento_id, cupom_id)
);

-- Tabela de Notificações
CREATE TABLE notificacoes (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuarios(id),
    tipo TEXT, -- Ex: 'alerta_preco', 'pedido_atualizado', 'promocao'
    mensagem TEXT,
    lida BOOLEAN DEFAULT FALSE,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ======================================
-- INSERÇÃO DE DADOS
-- ======================================

-- Lojas Afiliadas
INSERT INTO lojas_afiliadas (nome, site_url, logo_url) VALUES
('Kabum', 'https://www.kabum.com.br', '/logos/kabum.png'),
('Amazon', 'https://www.amazon.com.br', '/logos/amazon.png'),
('Terabyte', 'https://www.terabyteshop.com.br', '/logos/terabyte.png')
ON CONFLICT (nome) DO NOTHING;

-- ATIVOS DO SITE (logo e banner)
INSERT INTO ativos_site (nome, tipo, url) VALUES
('Logo Five Analysis', 'logo', '/logos/logotipo.png'),
('Banner Principal', 'banner', '/imagens/banner.jpg')
ON CONFLICT (nome) DO NOTHING;

-- Processadores
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(1, 'Processador AMD Ryzen 5 5600GT', 839.90, 'Processador', '/imagens/ryzen5-5600gt.jpg', 'AMD', 'Ryzen 5 5600GT')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(1, 6, 12, 3.6, 'AM4') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(2, 'Processador Intel Core i5 12400F', 774.90, 'Processador', '/imagens/i5-12400f.jpg', 'Intel', 'Core i5 12400F')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(2, 6, 12, 2.5, 'LGA 1700') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(3, 'Processador AMD Ryzen 5 7600', 1439.90, 'Processador', '/imagens/ryzen5-7600.jpg', 'AMD', 'Ryzen 5 7600')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(3, 6, 12, 3.8, 'AM5') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(4, 'Processador Intel Core i3 12100F', 654.90, 'Processador', '/imagens/i3-12100f.jpg', 'Intel', 'Core i3 12100F')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(4, 4, 8, 3.3, 'LGA 1700') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(5, 'Processador AMD Ryzen 3 4100', 479.90, 'Processador', '/imagens/ryzen3-4100.jpg', 'AMD', 'Ryzen 3 4100')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(5, 4, 8, 3.8, 'AM4') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(6, 'Processador Intel Core Ultra 7', 300.00, 'Processador', '/imagens/ultra7.jpg', 'Intel', 'Core Ultra 7')
ON CONFLICT (id) DO NOTHING;
INSERT INTO processadores (produto_id, nucleos, threads, frequencia, socket) VALUES
(6, 16, 22, 1.5, 'LGA 1851') ON CONFLICT (produto_id) DO NOTHING;

-- Placas Mãe
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(7, 'Placa Mãe Gigabyte Hd10M V2', 429.99, 'Placa Mãe', '/imagens/placa-mae-hd10m.jpg', 'Gigabyte', 'Hd10M V2')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_mae (produto_id, chipset, socket, memoria, slots_memoria) VALUES
(7, 'Intel', 'LGA 1700', 'DDR4', 4) ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(8, 'Placa Mãe Asus Prime H510M-E', 449.00, 'Placa Mãe', '/imagens/asus-prime-h510m.jpg', 'Asus', 'Prime H510M-E')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_mae (produto_id, chipset, socket, memoria, slots_memoria) VALUES
(8, 'Intel Unlocked', 'LGA 1200', 'DDR4', 4) ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(9, 'Placa Mãe ASRock B450M-HDV R4.0', 399.00, 'Placa Mãe', '/imagens/asrock-b450m-hdv.jpg', 'ASRock', 'B450M-HDV R4.0')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_mae (produto_id, chipset, socket, memoria, slots_memoria) VALUES
(9, 'AMD B450', 'AM4', 'DDR4', 2) ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(10, 'Placa Mãe ASRock B450M Steel Legend', 749.00, 'Placa Mãe', '/imagens/asrock-steel-legend.jpg', 'ASRock', 'B450M Steel Legend')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_mae (produto_id, chipset, socket, memoria, slots_memoria) VALUES
(10, 'AMD B450', 'AM4', 'DDR4', 4) ON CONFLICT (produto_id) DO NOTHING;

-- NOVO PRODUTO (Placa Mãe da imagem a2.jpg)
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(17, 'Placa Mãe ASRock B660 GTA', 899.90, 'Placa Mãe', '/imagens/a2.jpg', 'ASRock', 'B660 GTA')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_mae (produto_id, chipset, socket, memoria, slots_memoria) VALUES
(17, 'Intel B660', 'LGA 1700', 'DDR4', 4) ON CONFLICT (produto_id) DO NOTHING;


-- Periféricos
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(11, 'Cadeira Gamer SPG-456 Azul e Preta', 839.90, 'Periférico', '/imagens/cadeira-gamer.jpg', 'SPG', 'SPG-456')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(11, 'Cadeira Gamer', 'Fixa') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(12, 'Headset Gamer - DTS Led RGB', 774.90, 'Periférico', '/imagens/headset-gamer.jpg', 'DTS', 'Headset Gamer Led')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(12, 'Headset Gamer', 'Com fio') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(13, 'Mouse Gamer Sem Fio Logitech GPRO Wireless', 482.00, 'Periférico', '/imagens/mouse-gamer.jpg', 'Logitech', 'GPRO Wireless')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(13, 'Mouse Gamer', 'Sem fio') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(14, 'Teclado Mecânico Gamer Redragon Kumara RGB', 189.90, 'Periférico', '/imagens/teclado-redragon.jpg', 'Redragon', 'Kumara')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(14, 'Teclado Mecânico', 'Com fio') ON CONFLICT (produto_id) DO NOTHING;

INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(15, 'Controle Sony DualSense PS5', 371.99, 'Periférico', '/imagens/controle-ps5.jpg', 'Sony', 'DualSense PS5')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(15, 'Controle', 'Sem fio') ON CONFLICT (produto_id) DO NOTHING;

-- NOVO PRODUTO (Cadeira da imagem a1.jpg)
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(18, 'Cadeira Gamer Ergonômica', 1200.00, 'Periférico', '/imagens/a1.jpg', 'ThunderX3', 'EC1')
ON CONFLICT (id) DO NOTHING;
INSERT INTO perifericos (produto_id, tipo, caracteristica) VALUES
(18, 'Cadeira Gamer', 'Ajustável') ON CONFLICT (produto_id) DO NOTHING;

-- Monitores
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(16, 'Monitor Gamer SuperFrame VISION 24" Full HD', 650.00, 'Monitor', '/imagens/monitor-vision.jpg', 'SuperFrame', 'VISION 24"')
ON CONFLICT (id) DO NOTHING;
INSERT INTO monitores (produto_id, polegadas, resolucao, taxa_atualizacao) VALUES
(16, 24.0, '1920x1080', 75) ON CONFLICT (produto_id) DO NOTHING;

-- NOVO PRODUTO (Monitor da imagem a3.jpg)
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(19, 'Monitor BenQ Mobiuz EX2710Q 27"', 2199.99, 'Monitor', '/imagens/a3.jpg', 'BenQ', 'Mobiuz EX2710Q')
ON CONFLICT (id) DO NOTHING;
INSERT INTO monitores (produto_id, polegadas, resolucao, taxa_atualizacao) VALUES
(19, 27.0, '2560x1440', 165) ON CONFLICT (produto_id) DO NOTHING;

-- Placas de Vídeo
-- NOVO PRODUTO (Placa de Vídeo da imagem a4.jpg)
INSERT INTO produtos (id, nome, preco, categoria, imagem_url, marca, modelo) VALUES
(20, 'Placa de Vídeo RX 6700 XT Dual', 2599.90, 'Placa de Vídeo', '/imagens/a4.jpg', 'XFX', 'RX 6700 XT')
ON CONFLICT (id) DO NOTHING;
INSERT INTO placas_video (produto_id, memoria_vram, interface, barramento) VALUES
(20, 12.0, 'PCIe 4.0', '256-bit') ON CONFLICT (produto_id) DO NOTHING;


-- ======================================
-- PRODUTOS AFILIADOS
-- ======================================
-- Ryzen 5 5600GT
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(1, 1, 839.90, 'https://www.kabum.com.br/produto/ryzen5-5600gt?aff=123'),
(1, 2, 859.90, 'https://www.amazon.com.br/dp/ryzen5-5600gt?tag=afiliado123'),
(1, 3, 845.00, 'https://www.terabyteshop.com.br/produto/ryzen5-5600gt?aff=123')
ON CONFLICT DO NOTHING;

-- Intel Core i5 12400F
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(2, 1, 774.90, 'https://www.kabum.com.br/produto/i5-12400f?aff=123'),
(2, 2, 789.00, 'https://www.amazon.com.br/dp/i5-12400f?tag=afiliado123'),
(2, 3, 780.00, 'https://www.terabyteshop.com.br/produto/i5-12400f?aff=123')
ON CONFLICT DO NOTHING;

-- Monitor VISION 24
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(16, 1, 650.00, 'https://www.kabum.com.br/produto/vision24?aff=123'),
(16, 2, 679.00, 'https://www.amazon.com.br/dp/vision24?tag=afiliado123'),
(16, 3, 665.00, 'https://www.terabyteshop.com.br/produto/vision24?aff=123')
ON CONFLICT DO NOTHING;

-- PRODUTOS AFILIADOS RESTANTES
-- AMD Ryzen 5 7600
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(3, 1, 1439.90, 'https://www.kabum.com.br/produto/ryzen5-7600?aff=123'),
(3, 2, 1459.00, 'https://www.amazon.com.br/dp/ryzen5-7600?tag=afiliado123'),
(3, 3, 1445.00, 'https://www.terabyteshop.com.br/produto/ryzen5-7600?aff=123')
ON CONFLICT DO NOTHING;

-- Intel Core i3 12100F
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(4, 1, 654.90, 'https://www.kabum.com.br/produto/i3-12100f?aff=123'),
(4, 2, 669.00, 'https://www.amazon.com.br/dp/i3-12100f?tag=afiliado123'),
(4, 3, 659.00, 'https://www.terabyteshop.com.br/produto/i3-12100f?aff=123')
ON CONFLICT DO NOTHING;

-- AMD Ryzen 3 4100
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(5, 1, 479.90, 'https://www.kabum.com.br/produto/ryzen3-4100?aff=123'),
(5, 2, 495.00, 'https://www.amazon.com.br/dp/ryzen3-4100?tag=afiliado123'),
(5, 3, 485.00, 'https://www.terabyteshop.com.br/produto/ryzen3-4100?aff=123')
ON CONFLICT DO NOTHING;

-- Intel Core Ultra 7
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(6, 1, 300.00, 'https://www.kabum.com.br/produto/core-ultra7?aff=123'),
(6, 2, 310.00, 'https://www.amazon.com.br/dp/core-ultra7?tag=afiliado123'),
(6, 3, 305.00, 'https://www.terabyteshop.com.br/produto/core-ultra7?aff=123')
ON CONFLICT DO NOTHING;

-- Placa Mãe Gigabyte Hd10M V2
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(7, 1, 429.99, 'https://www.kabum.com.br/produto/hd10m-v2?aff=123'),
(7, 2, 445.00, 'https://www.amazon.com.br/dp/hd10m-v2?tag=afiliado123'),
(7, 3, 435.00, 'https://www.terabyteshop.com.br/produto/hd10m-v2?aff=123')
ON CONFLICT DO NOTHING;

-- Placa Mãe Asus Prime H510M-E
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(8, 1, 449.00, 'https://www.kabum.com.br/produto/asus-prime-h510m-e?aff=123'),
(8, 2, 460.00, 'https://www.amazon.com.br/dp/asus-prime-h510m-e?tag=afiliado123'),
(8, 3, 455.00, 'https://www.terabyteshop.com.br/produto/asus-prime-h510m-e?aff=123')
ON CONFLICT DO NOTHING;

-- ASRock B450M-HDV R4.0
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(9, 1, 399.00, 'https://www.kabum.com.br/produto/asrock-b450m-hdv?aff=123'),
(9, 2, 410.00, 'https://www.amazon.com.br/dp/asrock-b450m-hdv?tag=afiliado123'),
(9, 3, 405.00, 'https://www.terabyteshop.com.br/produto/asrock-b450m-hdv?aff=123')
ON CONFLICT DO NOTHING;

-- ASRock B450M Steel Legend
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(10, 1, 749.00, 'https://www.kabum.com.br/produto/asrock-b450m-steel?aff=123'),
(10, 2, 769.00, 'https://www.amazon.com.br/dp/asrock-b450m-steel?tag=afiliado123'),
(10, 3, 755.00, 'https://www.terabyteshop.com.br/produto/asrock-b450m-steel?aff=123')
ON CONFLICT DO NOTHING;

-- Cadeira Gamer SPG-456
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(11, 1, 839.90, 'https://www.kabum.com.br/produto/cadeira-spg456?aff=123'),
(11, 2, 859.00, 'https://www.amazon.com.br/dp/cadeira-spg456?tag=afiliado123'),
(11, 3, 845.00, 'https://www.terabyteshop.com.br/produto/cadeira-spg456?aff=123')
ON CONFLICT DO NOTHING;

-- Headset Gamer DTS
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(12, 1, 774.90, 'https://www.kabum.com.br/produto/headset-dts?aff=123'),
(12, 2, 789.00, 'https://www.amazon.com.br/dp/headset-dts?tag=afiliado123'),
(12, 3, 780.00, 'https://www.terabyteshop.com.br/produto/headset-dts?aff=123')
ON CONFLICT DO NOTHING;

-- Mouse Logitech GPRO
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(13, 1, 482.00, 'https://www.kabum.com.br/produto/mouse-gpro?aff=123'),
(13, 2, 495.00, 'https://www.amazon.com.br/dp/mouse-gpro?tag=afiliado123'),
(13, 3, 485.00, 'https://www.terabyteshop.com.br/produto/mouse-gpro?aff=123')
ON CONFLICT DO NOTHING;

-- Teclado Redragon Kumara
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(14, 1, 189.90, 'https://www.kabum.com.br/produto/teclado-kumara?aff=123'),
(14, 2, 199.00, 'https://www.amazon.com.br/dp/teclado-kumara?tag=afiliado123'),
(14, 3, 195.00, 'https://www.terabyteshop.com.br/produto/teclado-kumara?aff=123')
ON CONFLICT DO NOTHING;

-- Controle Sony DualSense
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(15, 1, 371.99, 'https://www.kabum.com.br/produto/controle-dualsense?aff=123'),
(15, 2, 389.00, 'https://www.amazon.com.br/dp/controle-dualsense?tag=afiliado123'),
(15, 3, 380.00, 'https://www.terabyteshop.com.br/produto/controle-dualsense?aff=123')
ON CONFLICT DO NOTHING;

-- NOVO PRODUTO AFILIADO (Placa Mãe da imagem a2.jpg)
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(17, 1, 899.90, 'https://www.kabum.com.br/produto/asrock-b660-gta?aff=123'),
(17, 2, 915.00, 'https://www.amazon.com.br/dp/asrock-b660-gta?tag=afiliado123'),
(17, 3, 905.00, 'https://www.terabyteshop.com.br/produto/asrock-b660-gta?aff=123')
ON CONFLICT DO NOTHING;

-- NOVO PRODUTO AFILIADO (Cadeira da imagem a1.jpg)
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(18, 1, 1200.00, 'https://www.kabum.com.br/produto/cadeira-ec1?aff=123'),
(18, 2, 1250.00, 'https://www.amazon.com.br/dp/cadeira-ec1?tag=afiliado123'),
(18, 3, 1210.00, 'https://www.terabyteshop.com.br/produto/cadeira-ec1?aff=123')
ON CONFLICT DO NOTHING;

-- NOVO PRODUTO AFILIADO (Monitor da imagem a3.jpg)
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(19, 1, 2199.99, 'https://www.kabum.com.br/produto/benq-ex2710q?aff=123'),
(19, 2, 2250.00, 'https://www.amazon.com.br/dp/benq-ex2710q?tag=afiliado123'),
(19, 3, 2210.00, 'https://www.terabyteshop.com.br/produto/benq-ex2710q?aff=123')
ON CONFLICT DO NOTHING;

-- NOVO PRODUTO AFILIADO (Placa de Vídeo da imagem a4.jpg)
INSERT INTO produtos_afiliados (produto_id, loja_id, preco, url_afiliado) VALUES
(20, 1, 2599.90, 'https://www.kabum.com.br/produto/rx-6700-xt?aff=123'),
(20, 2, 2650.00, 'https://www.amazon.com.br/dp/rx-6700-xt?tag=afiliado123'),
(20, 3, 2610.00, 'https://www.terabyteshop.com.br/produto/rx-6700-xt?aff=123')
ON CONFLICT DO NOTHING;


-- ======================================
-- INSERÇÃO DE DADOS DE EXEMPLO
-- ======================================

-- Perfis de Usuários
INSERT INTO perfis_usuarios (nome) VALUES
('Cliente'),
('Administrador')
ON CONFLICT (nome) DO NOTHING;

-- Usuários
INSERT INTO usuarios (nome, email, senha, perfil_id) VALUES
('João da Silva', 'joao.silva@exemplo.com', 'senha123', (SELECT id FROM perfis_usuarios WHERE nome = 'Cliente')) ON CONFLICT (email) DO NOTHING;
INSERT INTO usuarios (nome, email, senha, perfil_id) VALUES
('Maria Souza', 'maria.souza@exemplo.com', 'senha123', (SELECT id FROM perfis_usuarios WHERE nome = 'Administrador')) ON CONFLICT (email) DO NOTHING;

-- Marcas
INSERT INTO marcas (nome) VALUES
('AMD'), ('Intel'), ('Gigabyte'), ('Asus'), ('ASRock'), ('SPG'), ('DTS'), ('Logitech'), ('Redragon'), ('Sony'), ('SuperFrame'), ('ThunderX3'), ('BenQ'), ('XFX')
ON CONFLICT (nome) DO NOTHING;

-- Categorias
INSERT INTO categorias (nome) VALUES
('Processador'), ('Placa Mãe'), ('Periférico'), ('Monitor'), ('Placa de Vídeo')
ON CONFLICT (nome) DO NOTHING;

-- Compatibilidade de Peças
-- Exemplo: Processador Intel i5 12400F (id 2) e Placa Mãe Gigabyte (id 7) são compatíveis
INSERT INTO compatibilidade_peca (peca1_id, peca2_id, status) VALUES
(2, 7, 'compativel'),
(7, 2, 'compativel'),
-- Exemplo: Processador AMD Ryzen 5 5600GT (id 1) e Placa Mãe Gigabyte (id 7) são incompatíveis
(1, 7, 'incompativel'),
(7, 1, 'incompativel')
ON CONFLICT DO NOTHING;

-- Log de Sistema
INSERT INTO log_sistema (tipo, descricao) VALUES
('informacao', 'Novo usuário cadastrado: joao.silva@exemplo.com'),
('aviso', 'Tentativa de login falha para joao.silva@exemplo.com');

-- Cupons de Desconto
INSERT INTO cupons_desconto (codigo, valor_desconto, tipo, data_validade) VALUES
('DESCONTO10', 10.00, 'porcentagem', '2026-12-31') ON CONFLICT DO NOTHING;
INSERT INTO cupons_desconto (codigo, valor_desconto, tipo, data_validade) VALUES
('FRETEGRATIS', 0.00, 'frete', '2025-12-31') ON CONFLICT DO NOTHING;

-- Avaliações de Produtos
INSERT INTO avaliacoes_produtos (usuario_id, produto_id, nota, comentario)
VALUES ((SELECT id FROM usuarios WHERE email = 'joao.silva@exemplo.com'), (SELECT id FROM produtos WHERE nome = 'Processador AMD Ryzen 5 5600GT'), 5, 'Ótimo processador para jogos! Recomendo!')
ON CONFLICT DO NOTHING;

-- Notificações
INSERT INTO notificacoes (usuario_id, tipo, mensagem) VALUES
((SELECT id FROM usuarios WHERE email = 'joao.silva@exemplo.com'), 'alerta_preco', 'O preço do Monitor Gamer SuperFrame VISION 24" Full HD caiu! Clique aqui para conferir.')
ON CONFLICT DO NOTHING;
